# v5.3.0 "EVOQUE" — 2026-01-17

> ♚
>-  Evolved Intelligence: ML/RL Infrastructure, Discord Integration, Comprehensive Trade Collection. <br>
> - Stability improvements, runtime upgrades and comprehensive observability.

---

## ◆ Highlights

This release represents a fundamental evolution in Cthulu's intelligence capabilities. "EVOQUE" brings complete ML/RL training infrastructure, real-time Discord notifications, and comprehensive trade collection across all trade sources.

| Category | Enhancement |
|----------|-------------|
| **Intelligence** | Complete ML/RL pipeline with 6 training components |
| **Communication** | Discord webhooks across 3 dedicated channels |
| **Data** | Unified trade collection for system, RPC, and adopted trades |
| **Observability** | Enhanced analyzer with ML coverage + storage CLI |

---

## ◆ Added

### ML/RL Training Infrastructure

Complete machine learning pipeline for autonomous trading enhancement:

| Component | Purpose | Location |
|-----------|---------|----------|
| Price Predictor | Softmax classifier for direction prediction | `ML_RL/price_predictor.py` |
| Tier Optimizer | Analyze scaling outcomes, optimize tiers | `ML_RL/tier_optimizer.py` |
| RL Position Sizer | Hybrid Q-learning + PPO for position sizing | `ML_RL/rl_position_sizer.py` |
| LLM Analysis | Local LLM for market narrative generation | `ML_RL/llm_analysis.py` |
| Feature Pipeline | Technical indicators + regime detection | `ML_RL/feature_pipeline.py` |
| MLOps | Model versioning, drift detection, retraining | `ML_RL/mlops.py` |

Training modes:
- **Offline Training:** Historical data batch processing
- **Live Learning:** Real-time model updates during trading
- **Hybrid:** Background training with live inference

### Discord Integration

Automated alerts across three dedicated channels:

**◈ Alerts Channel:**
- Trade executions (entry/exit with PnL)
- Risk alerts (drawdown, margin, position limits)
- System health (connection failures, API errors)
- Adoption events (manual trade adoption)

**◈ Health Channel:**
- Session summaries (win/loss, total PnL)
- Model performance (accuracy, drift warnings)
- Portfolio snapshots (positions, exposure)

**◈ Signals Channel:**
- High-confidence setups detected
- Regime changes (trending↔ranging)
- Milestone events (profit targets, new highs)

Rate-limited (30 msg/min) with batch queuing.

### Comprehensive Trade Collection

Non-blocking trade metrics collection for all trade sources:

```
┌─────────────────────────────────────────────────────────┐
│                  TRADE SOURCES                          │
├─────────────────┬─────────────────┬─────────────────────┤
│  System Trades  │   RPC Trades    │   Adopted Trades    │
│  (Cthulu-init)  │  (External API) │  (Manual/Herald)    │
└────────┬────────┴────────┬────────┴──────────┬──────────┘
         │                 │                   │
         └────────────────►│◄──────────────────┘
                           ▼
              ┌────────────────────────┐
              │   TradeCollector       │
              │   (Background Queue)   │
              └───────────┬────────────┘
                          ▼
              ┌────────────────────────┐
              │   SQLite Persistence   │
              │   + Discord Alerts     │
              └────────────────────────┘
```

Metrics captured:
- Entry/exit prices, PnL, duration
- Slippage, execution quality
- Signal confidence, confluence score
- Trade source, adoption metadata

### Data Storage CLI

New utility for database and output tracking:

```bash
python tools/data_storage_cli.py --summary    # Space usage overview
python tools/data_storage_cli.py --detail     # Per-database breakdown
python tools/data_storage_cli.py --cleanup    # Remove old artifacts
```

### Enhanced Analyzer

`tools/analyze_cthulu.py` extended for ML/RL coverage:
- Model file analysis and metrics
- Training data pipeline validation
- Feature importance visualization
- Drift detection status

---

## ◆ Fixed

- ◈ Auto-tune runner import resolution for local LLM modules
- ◈ Trade metrics not recording for all trade types
- ◈ Summary system display issues during live loop
- ◈ Position adoption not operational for external trades
- ◈ News manager cache causing git conflicts
- ◈ PR #25 merge conflicts resolved

---

## ◆ Security

- Discord webhook URLs stored in `.env` (not committed)
- ML model files excluded from git tracking
- HuggingFace repository configured for model distribution
- AGPL-3.0 license standardized across all files
- `config_battle.json` removed from tracking (sensitive)
- `news/cache/news_manager.json` added to `.gitignore`

---

## Configuration Changes

### New `.env` Variables

```bash
# Discord Webhooks (Category: Cthulu)
DISCORD_WEBHOOK_ALERTS=https://discord.com/api/webhooks/...
DISCORD_WEBHOOK_HEALTH=https://discord.com/api/webhooks/...
DISCORD_WEBHOOK_SIGNALS=https://discord.com/api/webhooks/...
```

### New `config.json` Options

```json
{
  "discord": {
    "enabled": true,
    "alert_on_trade": true,
    "alert_on_risk": true,
    "alert_on_health": true,
    "alert_on_signals": true,
    "daily_digest": true,
    "digest_hour": 0
  },
  "ml": {
    "price_predictor_enabled": true,
    "tier_optimizer_enabled": true,
    "reinforcement_learning_enabled": false,
    "llm_analysis_enabled": false,
    "feature_pipeline_cache": true,
    "mlops_auto_retrain": true,
    "drift_threshold": 0.15
  },
  "trade_collection": {
    "enabled": true,
    "batch_size": 50,
    "flush_interval_seconds": 60
  }
}
```

---

## Files Added

### ML/RL Infrastructure
- `ML_RL/price_predictor.py` — Softmax classifier
- `ML_RL/tier_optimizer.py` — Profit tier analysis
- `ML_RL/rl_position_sizer.py` — Q-learning + PPO
- `ML_RL/llm_analysis.py` — Local LLM integration
- `ML_RL/feature_pipeline.py` — Feature engineering
- `ML_RL/mlops.py` — Model lifecycle management
- `ML_RL/train_models.py` — Training orchestrator
- `ML_RL/ML_ARCHITECTURE.md` — Architecture docs
- `ML_RL/system_map.md` — Endpoint mapping

### Discord Integration
- `integrations/discord_notifier.py` — Webhook manager

### Trade Collection
- `core/trade_collector.py` — Metrics collection
- `position/adoption.py` — Enhanced adoption

### Tools
- `tools/data_storage_cli.py` — Space tracking

---

## Files Changed

- `core/bootstrap.py` — Discord initialization, trade collector startup
- `core/shutdown.py` — Session summary alerts, graceful collector shutdown
- `core/trading_loop.py` — Trade collection integration
- `rpc/server.py` — RPC trade collection hooks
- `tools/analyze_cthulu.py` — ML/RL analysis coverage
- `.env` — Discord webhook configuration
- `.gitignore` — ML model files, news cache

---

## Migration Guide

### 1. Update Environment

```bash
# Add to .env
DISCORD_WEBHOOK_ALERTS=<your-alerts-webhook>
DISCORD_WEBHOOK_HEALTH=<your-health-webhook>
DISCORD_WEBHOOK_SIGNALS=<your-signals-webhook>
```

### 2. Install Dependencies

```bash
pip install -r requirements.txt
```

### 3. Train Models (Optional)

```bash
python ML_RL/train_models.py --all
```

### 4. Verify Integration

```bash
python tools/analyze_cthulu.py --ml
python tools/data_storage_cli.py --summary
```

---

## Philosophy

"EVOQUE" embodies **evolved intelligence**:

1. **Capture everything** — Every trade, every metric, every signal
2. **Learn continuously** — ML models improve with each trade
3. **Alert instantly** — Discord notifications for real-time awareness
4. **Track resources** — Database and storage monitoring
5. **Train autonomously** — MLOps for automatic model improvement

---

*"From the depths, intelligence rises."*

---

**Release drafted by:** Cthulu Development Team  
**Date:** 2026-01-17  
**Git Tag:** `v5.3.0`  
**Codename:** EVOQUE
